<!DOCTYPE html>
<html lang="ja" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>osAIfu „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        .nav-item { 
            transition: all 0.2s ease;
            border-radius: 12px;
        }
        .nav-item:hover { 
            background-color: rgba(99, 91, 255, 0.1);
        }
        .nav-item.active { 
            background-color: rgba(99, 91, 255, 0.15);
            color: #635BFF;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #635BFF 0%, #8B7EFF 100%);
        }
        
        .card-row {
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .card-row:hover {
            background-color: rgba(99, 91, 255, 0.05);
            transform: translateY(-1px);
        }
        
        .card-visual {
            background: linear-gradient(135deg, #635BFF 0%, #8B7EFF 100%);
            transform: perspective(1000px) rotateX(5deg) rotateY(-2deg);
            animation: cardFloat 3s ease-in-out infinite;
        }
        
        /* 3D Card Styling */
        .card-3d {
            background: linear-gradient(135deg, #635BFF 0%, #9C7EFF 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
            width: 340px;
            height: 200px;
            position: relative;
            transform: perspective(1000px) rotateY(-5deg) rotateX(5deg);
            transition: transform 0.5s ease;
            box-shadow: 0 20px 60px rgba(99, 91, 255, 0.3);
        }
        .card-3d:hover {
            transform: perspective(1000px) rotateY(5deg) rotateX(-2deg);
        }
        
        .card-3d-appear {
            animation: card3dAppear 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        @keyframes card3dAppear {
            0% { 
                transform: perspective(1000px) rotateY(90deg) rotateX(45deg) scale(0.3);
                opacity: 0;
            }
            50% {
                transform: perspective(1000px) rotateY(-10deg) rotateX(10deg) scale(1.05);
                opacity: 0.8;
            }
            100% { 
                transform: perspective(1000px) rotateY(-5deg) rotateX(5deg) scale(1);
                opacity: 1;
            }
        }
        
        .card-details-expanded {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.3s ease;
            opacity: 0;
        }
        .card-details-expanded.active {
            max-height: 800px;
            opacity: 1;
        }
        
        .copy-button {
            transition: all 0.2s ease;
        }
        .copy-button:hover {
            transform: scale(1.05);
        }
        
        @keyframes cardFloat {
            0%, 100% { transform: perspective(1000px) rotateX(5deg) rotateY(-2deg) translateY(0px); }
            50% { transform: perspective(1000px) rotateX(5deg) rotateY(-2deg) translateY(-5px); }
        }
        
        @keyframes cardAppear {
            0% { 
                transform: perspective(1000px) rotateX(45deg) rotateY(45deg) scale(0.5);
                opacity: 0;
            }
            100% { 
                transform: perspective(1000px) rotateX(5deg) rotateY(-2deg) scale(1);
                opacity: 1;
            }
        }
        
        .card-appear {
            animation: cardAppear 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 50;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeIn 0.3s ease-out;
        }
        
        .step-content {
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: absolute;
            inset: 0;
        }
        .step-content.active {
            transform: translateX(0);
            opacity: 1;
            position: relative;
        }
        .step-content.prev {
            transform: translateX(-100%);
            opacity: 0;
        }
        
        .range-slider {
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            border-radius: 4px;
            background: #374151;
            outline: none;
            transition: background 0.2s;
        }
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #635BFF;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 4px 12px rgba(99, 91, 255, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .range-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(99, 91, 255, 0.6);
        }
        
        .inline-edit {
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 6px;
            transition: all 0.2s;
        }
        .inline-edit:hover {
            background-color: rgba(99, 91, 255, 0.1);
        }
        
        .lang-toggle.active {
            background-color: #635BFF;
            color: white;
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .accordion-content.expanded {
            max-height: 1000px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            .sidebar.open {
                transform: translateX(0);
            }
            
            .card-3d {
                width: 280px;
                height: 160px;
                padding: 16px;
            }
            
            .card-details-expanded .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#635BFF',
                        secondary: '#8B7EFF'
                    }
                }
            }
        }
    </script>
</head>
<body class="h-full" style="background-color: #0f0f0f; color: white;">
    <div class="flex h-full">
        <!-- Mobile menu overlay -->
        <div id="mobile-overlay" class="fixed inset-0 bg-black/50 z-40 lg:hidden hidden" onclick="toggleMobileSidebar()"></div>
        
        <!-- Sidebar -->
        <nav id="sidebar" class="sidebar fixed lg:relative lg:translate-x-0 w-64 h-full z-50 flex-shrink-0 flex flex-col border-r" style="background-color: #1a1a2e; border-color: rgba(99, 91, 255, 0.2);">
            <!-- Logo -->
            <div class="p-8 border-b" style="border-color: rgba(99, 91, 255, 0.2);">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-secondary flex items-center justify-center text-xl">
                        üëõ
                    </div>
                    <span class="text-2xl font-bold">osAIfu</span>
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="flex-1 p-6">
                <ul class="space-y-2">
                    <li>
                        <a href="#" onclick="showView('home')" class="nav-item active flex items-center space-x-4 px-4 py-3 text-sm font-medium rounded-xl">
                            <span class="text-xl">üè†</span>
                            <span data-i18n="home">„Éõ„Éº„É†</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="openCardIssuanceModal()" class="nav-item w-full flex items-center space-x-4 px-4 py-3 text-sm font-medium rounded-xl text-left">
                            <span class="text-xl">‚ûï</span>
                            <span data-i18n="issue_card">„Ç´„Éº„ÉâÁô∫Ë°å</span>
                        </button>
                    </li>
                    <li>
                        <a href="#" onclick="showView('transactions')" class="nav-item flex items-center space-x-4 px-4 py-3 text-sm font-medium rounded-xl">
                            <span class="text-xl">üìã</span>
                            <span data-i18n="transactions">ÂèñÂºïÂ±•Ê≠¥</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" onclick="showView('settings')" class="nav-item flex items-center space-x-4 px-4 py-3 text-sm font-medium rounded-xl">
                            <span class="text-xl">‚öôÔ∏è</span>
                            <span data-i18n="settings">Ë®≠ÂÆö</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 overflow-hidden flex flex-col">
            <!-- Header -->
            <header class="px-8 py-6 border-b" style="border-color: rgba(99, 91, 255, 0.2);">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <button onclick="toggleMobileSidebar()" class="lg:hidden p-2 hover:bg-gray-800 rounded-lg transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                        <div>
                            <h1 id="page-title" class="text-2xl font-bold" data-i18n="home">„Éõ„Éº„É†</h1>
                            <p id="page-subtitle" class="text-gray-400 mt-1" data-i18n="home_subtitle">AI„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅÆ„Ç´„Éº„Éâ„ÇíÁÆ°ÁêÜ</p>
                        </div>
                    </div>
                    
                    <!-- Language Toggle -->
                    <div class="flex items-center bg-gray-800/50 rounded-xl p-1">
                        <button id="lang-jp" class="lang-toggle px-4 py-2 rounded-lg text-sm font-medium transition-all active" onclick="switchLanguage('jp')">JP</button>
                        <button id="lang-en" class="lang-toggle px-4 py-2 rounded-lg text-sm font-medium transition-all text-gray-400" onclick="switchLanguage('en')">EN</button>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-8 max-w-7xl mx-auto">
                    <!-- Home Section -->
                    <section id="home-view" class="view-section active">
                        <!-- KPIs -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                            <!-- Monthly Spend -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-8 hover:border-primary/30 transition-all slide-up">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-400 text-sm font-medium mb-2" data-i18n="monthly_spend">‰ªäÊúà„ÅÆÂà©Áî®È°ç</p>
                                        <p class="text-4xl font-bold mb-1">¬•746,500</p>
                                        <p class="text-gray-500 text-sm">$5,120 USD</p>
                                    </div>
                                    <div class="text-5xl opacity-80">üí∞</div>
                                </div>
                            </div>

                            <!-- Active Cards -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-8 hover:border-primary/30 transition-all slide-up" style="animation-delay: 0.1s;">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-400 text-sm font-medium mb-2" data-i18n="issued_cards">Áô∫Ë°å„Ç´„Éº„ÉâÊï∞</p>
                                        <p class="text-4xl font-bold mb-1" id="card-count">4</p>
                                        <p class="text-green-400 text-sm font-medium" data-i18n="all_active">„Åô„Åπ„Å¶ÊúâÂäπ</p>
                                    </div>
                                    <div class="text-5xl opacity-80">üí≥</div>
                                </div>
                            </div>
                        </div>

                        <!-- Card List -->
                        <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl overflow-hidden slide-up" style="animation-delay: 0.2s;">
                            <div class="p-8 border-b border-gray-800/50">
                                <div class="flex items-center justify-between">
                                    <h2 class="text-2xl font-bold" data-i18n="card_list">„Ç´„Éº„Éâ‰∏ÄË¶ß</h2>
                                    <button onclick="openCardIssuanceModal()" class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-xl font-medium transition-all transform hover:scale-105" data-i18n="new_card">
                                        ‚ûï Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„ÇíÁô∫Ë°å
                                    </button>
                                </div>
                            </div>
                            
                            <div id="cards-container" class="divide-y divide-gray-800/50">
                                <!-- Card 1 -->
                                <div class="card-row p-8" onclick="toggleCardDetails(this)">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-6">
                                            <div class="w-12 h-8 bg-gradient-to-r from-primary to-secondary rounded-lg flex items-center justify-center text-white font-bold text-sm">
                                                CARD
                                            </div>
                                            <div>
                                                <h3 class="text-lg font-semibold mb-1">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</h3>
                                                <p class="text-gray-400 text-sm">Ad-Optimizer (OpenClaw)</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-8">
                                            <div class="text-right">
                                                <p class="font-mono text-lg font-bold"><span class="inline-edit" data-current="320000" data-max="400000" onclick="enableInlineEdit(event, this)">¬•320,000</span> / ¬•400,000</p>
                                                <div class="w-48 bg-gray-800 rounded-full h-2 mt-2">
                                                    <div class="progress-bar h-2 rounded-full" style="width: 80%"></div>
                                                </div>
                                            </div>
                                            <span class="px-4 py-2 bg-green-900/30 text-green-400 rounded-full text-sm font-medium">üü¢ <span data-i18n="active">ÊúâÂäπ</span></span>
                                            <svg class="w-5 h-5 text-gray-400 transition-transform expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                            </svg>
                                        </div>
                                    </div>
                                    <div class="card-details-expanded mt-8">
                                        <div class="bg-gray-800/30 rounded-xl p-6 grid lg:grid-cols-2 gap-8">
                                            <!-- 3D Card Visual -->
                                            <div class="flex justify-center lg:justify-start">
                                                <div class="card-3d">
                                                    <div class="absolute inset-0 flex flex-col justify-between">
                                                        <div class="flex justify-between items-start">
                                                            <div class="text-white">
                                                                <div class="text-sm opacity-80">osAIfu Card</div>
                                                                <div class="font-bold text-lg">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</div>
                                                            </div>
                                                            <div class="text-white text-xl font-bold">VISA</div>
                                                        </div>
                                                        <div class="flex justify-between items-end text-white">
                                                            <div>
                                                                <div class="text-sm font-mono">**** **** **** 1234</div>
                                                                <div class="text-xs opacity-80 mt-1">12/28</div>
                                                            </div>
                                                            <div class="text-right">
                                                                <div class="text-xs opacity-80">Monthly</div>
                                                                <div class="font-bold">¬•400,000</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Card Details -->
                                            <div class="space-y-6">
                                                <div class="space-y-4">
                                                    <h4 class="font-semibold text-primary" data-i18n="card_details">„Ç´„Éº„ÉâË©≥Á¥∞</h4>
                                                    <div class="space-y-3 text-sm">
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-gray-400">„Ç´„Éº„ÉâÁï™Âè∑:</span>
                                                            <div class="flex items-center space-x-2">
                                                                <span id="card-number-masked" class="font-mono">**** **** **** 1234</span>
                                                                <button onclick="toggleCardNumber(this, '4532 1234 5678 1234')" class="text-primary hover:text-primary/80 text-xs underline">Ë°®Á§∫</button>
                                                            </div>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400">ÊúâÂäπÊúüÈôê:</span>
                                                            <span class="font-mono">12/28</span>
                                                        </div>
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-gray-400">CVC:</span>
                                                            <div class="flex items-center space-x-2">
                                                                <span id="cvc-masked" class="font-mono">***</span>
                                                                <button onclick="toggleCVC(this, '123')" class="text-primary hover:text-primary/80 text-xs underline">Ë°®Á§∫</button>
                                                            </div>
                                                        </div>
                                                        <div class="flex justify-between items-center">
                                                            <span class="text-gray-400">Card ID:</span>
                                                            <div class="flex items-center space-x-2">
                                                                <span class="font-mono text-xs">card_ad1234567890</span>
                                                                <button onclick="copyTextToClipboard('card_ad1234567890')" class="copy-button bg-primary hover:bg-primary/90 text-white px-2 py-1 rounded text-xs">
                                                                    <span data-i18n="copy">„Ç≥„Éî„Éº</span>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400" data-i18n="currency">ÈÄöË≤®:</span>
                                                            <span>JPY</span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400" data-i18n="created">‰ΩúÊàêÊó•:</span>
                                                            <span>2024-02-15</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="space-y-4">
                                                    <h4 class="font-semibold text-primary" data-i18n="usage_rules">Âà©Áî®„É´„Éº„É´</h4>
                                                    <div class="space-y-2 text-sm">
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400" data-i18n="per_transaction">1Âõû‰∏äÈôê:</span>
                                                            <span>¬•50,000</span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400" data-i18n="categories">„Ç´„ÉÜ„Ç¥„É™:</span>
                                                            <span class="text-xs">Â∫ÉÂëä, „ÇØ„É©„Ç¶„Éâ</span>
                                                        </div>
                                                        <div class="flex justify-between">
                                                            <span class="text-gray-400" data-i18n="approval_limit">ÊâøË™çÂøÖË¶Å:</span>
                                                            <span>¬•50,000+</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card 2 -->
                                <div class="card-row p-8" onclick="toggleCardDetails(this)">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-6">
                                            <div class="w-12 h-8 bg-gradient-to-r from-primary to-secondary rounded-lg flex items-center justify-center text-white font-bold text-sm">
                                                CARD
                                            </div>
                                            <div>
                                                <h3 class="text-lg font-semibold mb-1">SaaSÊ±∫Ê∏à„Ç´„Éº„Éâ</h3>
                                                <p class="text-gray-400 text-sm">SaaS-Manager (OpenClaw)</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-8">
                                            <div class="text-right">
                                                <p class="font-mono text-lg font-bold"><span class="inline-edit" data-current="142800" data-max="200000" onclick="enableInlineEdit(event, this)">¬•142,800</span> / ¬•200,000</p>
                                                <div class="w-48 bg-gray-800 rounded-full h-2 mt-2">
                                                    <div class="progress-bar h-2 rounded-full" style="width: 71%"></div>
                                                </div>
                                            </div>
                                            <span class="px-4 py-2 bg-green-900/30 text-green-400 rounded-full text-sm font-medium">üü¢ <span data-i18n="active">ÊúâÂäπ</span></span>
                                            <svg class="w-5 h-5 text-gray-400 transition-transform expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card 3 -->
                                <div class="card-row p-8" onclick="toggleCardDetails(this)">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-6">
                                            <div class="w-12 h-8 bg-gradient-to-r from-primary to-secondary rounded-lg flex items-center justify-center text-white font-bold text-sm">
                                                CARD
                                            </div>
                                            <div>
                                                <h3 class="text-lg font-semibold mb-1">„Éá„Éº„ÇøÂàÜÊûê„Ç´„Éº„Éâ</h3>
                                                <p class="text-gray-400 text-sm">Data-Crawler (OpenClaw)</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-8">
                                            <div class="text-right">
                                                <p class="font-mono text-lg font-bold"><span class="inline-edit" data-current="180200" data-max="300000" onclick="enableInlineEdit(event, this)">¬•180,200</span> / ¬•300,000</p>
                                                <div class="w-48 bg-gray-800 rounded-full h-2 mt-2">
                                                    <div class="progress-bar h-2 rounded-full" style="width: 60%"></div>
                                                </div>
                                            </div>
                                            <span class="px-4 py-2 bg-green-900/30 text-green-400 rounded-full text-sm font-medium">üü¢ <span data-i18n="active">ÊúâÂäπ</span></span>
                                            <svg class="w-5 h-5 text-gray-400 transition-transform expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>

                                <!-- Card 4 -->
                                <div class="card-row p-8" onclick="toggleCardDetails(this)">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-6">
                                            <div class="w-12 h-8 bg-gradient-to-r from-gray-600 to-gray-500 rounded-lg flex items-center justify-center text-white font-bold text-sm">
                                                CARD
                                            </div>
                                            <div>
                                                <h3 class="text-lg font-semibold mb-1 text-gray-400">ÈñãÁô∫ÊîØÊè¥„Ç´„Éº„Éâ</h3>
                                                <p class="text-gray-500 text-sm">Code-Assistant (OpenClaw)</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-8">
                                            <div class="text-right">
                                                <p class="font-mono text-lg font-bold text-gray-400"><span class="inline-edit" data-current="103500" data-max="200000" onclick="enableInlineEdit(event, this)">¬•103,500</span> / ¬•200,000</p>
                                                <div class="w-48 bg-gray-800 rounded-full h-2 mt-2">
                                                    <div class="bg-gray-600 h-2 rounded-full" style="width: 52%"></div>
                                                </div>
                                            </div>
                                            <span class="px-4 py-2 bg-gray-800/30 text-gray-400 rounded-full text-sm font-medium">‚è∏Ô∏è <span data-i18n="paused">‰∏ÄÊôÇÂÅúÊ≠¢</span></span>
                                            <svg class="w-5 h-5 text-gray-400 transition-transform expand-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Transactions Section -->
                    <section id="transactions-view" class="view-section" style="display: none;">
                        <div class="mb-8">
                            <!-- Filters -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-6 mb-8">
                                <div class="grid md:grid-cols-3 gap-4">
                                    <select class="bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary">
                                        <option data-i18n="all_cards">„Åô„Åπ„Å¶„ÅÆ„Ç´„Éº„Éâ</option>
                                        <option>Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</option>
                                        <option>SaaSÊ±∫Ê∏à„Ç´„Éº„Éâ</option>
                                        <option>„Éá„Éº„ÇøÂàÜÊûê„Ç´„Éº„Éâ</option>
                                        <option>ÈñãÁô∫ÊîØÊè¥„Ç´„Éº„Éâ</option>
                                    </select>
                                    <select class="bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary">
                                        <option data-i18n="all_status">„Åô„Åπ„Å¶„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ</option>
                                        <option data-i18n="approved">ÊâøË™ç</option>
                                        <option data-i18n="blocked">„Éñ„É≠„ÉÉ„ÇØ</option>
                                    </select>
                                    <select class="bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary">
                                        <option data-i18n="last_30_days">ÈÅéÂéª30Êó•</option>
                                        <option data-i18n="last_7_days">ÈÅéÂéª7Êó•</option>
                                        <option data-i18n="today">‰ªäÊó•</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Transactions Table -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead style="background-color: rgba(26, 26, 46, 0.5);">
                                            <tr>
                                                <th class="text-left py-6 px-8 text-sm font-semibold text-gray-300" data-i18n="datetime">Êó•ÊôÇ</th>
                                                <th class="text-left py-6 px-8 text-sm font-semibold text-gray-300" data-i18n="card_name">„Ç´„Éº„ÉâÂêç</th>
                                                <th class="text-left py-6 px-8 text-sm font-semibold text-gray-300" data-i18n="merchant">Âä†ÁõüÂ∫ó</th>
                                                <th class="text-left py-6 px-8 text-sm font-semibold text-gray-300" data-i18n="amount">ÈáëÈ°ç</th>
                                                <th class="text-left py-6 px-8 text-sm font-semibold text-gray-300" data-i18n="status">„Çπ„ÉÜ„Éº„Çø„Çπ</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-800/30">
                                            <tr class="hover:bg-gray-800/20 transition-colors">
                                                <td class="py-6 px-8 text-sm text-gray-300">2024-02-17 08:23</td>
                                                <td class="py-6 px-8 text-sm font-medium">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</td>
                                                <td class="py-6 px-8 text-sm">Google Ads</td>
                                                <td class="py-6 px-8 text-sm font-mono text-lg font-bold">¬•45,000</td>
                                                <td class="py-6 px-8">
                                                    <span class="px-3 py-1 bg-green-900/30 text-green-400 rounded-full text-xs font-medium" data-i18n="approved">ÊâøË™çÊ∏à„Åø</span>
                                                </td>
                                            </tr>
                                            <tr class="hover:bg-gray-800/20 transition-colors">
                                                <td class="py-6 px-8 text-sm text-gray-300">2024-02-17 04:12</td>
                                                <td class="py-6 px-8 text-sm font-medium">„Éá„Éº„ÇøÂèéÈõÜ„Ç´„Éº„Éâ</td>
                                                <td class="py-6 px-8 text-sm text-gray-500">Unknown</td>
                                                <td class="py-6 px-8 text-sm font-mono text-lg font-bold text-red-400">¬•89,000</td>
                                                <td class="py-6 px-8">
                                                    <span class="px-3 py-1 bg-red-900/30 text-red-400 rounded-full text-xs font-medium" data-i18n="blocked">„Éñ„É≠„ÉÉ„ÇØ</span>
                                                </td>
                                            </tr>
                                            <tr class="hover:bg-gray-800/20 transition-colors">
                                                <td class="py-6 px-8 text-sm text-gray-300">2024-02-17 07:15</td>
                                                <td class="py-6 px-8 text-sm font-medium">SaaSÊ±∫Ê∏à„Ç´„Éº„Éâ</td>
                                                <td class="py-6 px-8 text-sm">Notion</td>
                                                <td class="py-6 px-8 text-sm font-mono text-lg font-bold">¬•3,200</td>
                                                <td class="py-6 px-8">
                                                    <span class="px-3 py-1 bg-green-900/30 text-green-400 rounded-full text-xs font-medium" data-i18n="approved">ÊâøË™çÊ∏à„Åø</span>
                                                </td>
                                            </tr>
                                            <tr class="hover:bg-gray-800/20 transition-colors">
                                                <td class="py-6 px-8 text-sm text-gray-300">2024-02-16 18:20</td>
                                                <td class="py-6 px-8 text-sm font-medium">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</td>
                                                <td class="py-6 px-8 text-sm">Facebook Ads</td>
                                                <td class="py-6 px-8 text-sm font-mono text-lg font-bold">¬•28,500</td>
                                                <td class="py-6 px-8">
                                                    <span class="px-3 py-1 bg-green-900/30 text-green-400 rounded-full text-xs font-medium" data-i18n="approved">ÊâøË™çÊ∏à„Åø</span>
                                                </td>
                                            </tr>
                                            <tr class="hover:bg-gray-800/20 transition-colors">
                                                <td class="py-6 px-8 text-sm text-gray-300">2024-02-16 14:35</td>
                                                <td class="py-6 px-8 text-sm font-medium">SaaSÊ±∫Ê∏à„Ç´„Éº„Éâ</td>
                                                <td class="py-6 px-8 text-sm">AWS</td>
                                                <td class="py-6 px-8 text-sm font-mono text-lg font-bold">¬•12,800</td>
                                                <td class="py-6 px-8">
                                                    <span class="px-3 py-1 bg-green-900/30 text-green-400 rounded-full text-xs font-medium" data-i18n="approved">ÊâøË™çÊ∏à„Åø</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Settings Section -->
                    <section id="settings-view" class="view-section" style="display: none;">
                        <div class="space-y-8">
                            <!-- Notifications -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-8">
                                <h2 class="text-xl font-bold mb-6" data-i18n="notifications">ÈÄöÁü•Ë®≠ÂÆö</h2>
                                <div class="space-y-6">
                                    <div class="flex items-center justify-between py-4 border-b border-gray-800/30">
                                        <div>
                                            <h3 class="font-semibold" data-i18n="email_notifications">„É°„Éº„É´ÈÄöÁü•</h3>
                                            <p class="text-gray-400 text-sm" data-i18n="email_desc">ÂèñÂºï„ÅÆÊâøË™ç/„Éñ„É≠„ÉÉ„ÇØÊôÇ„Å´„É°„Éº„É´„ÇíÂèó‰ø°</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer" checked>
                                            <div class="w-14 h-7 bg-gray-600 rounded-full peer peer-checked:bg-primary peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all"></div>
                                        </label>
                                    </div>
                                    <div class="flex items-center justify-between py-4 border-b border-gray-800/30">
                                        <div>
                                            <h3 class="font-semibold" data-i18n="slack_notifications">SlackÈÄöÁü•</h3>
                                            <p class="text-gray-400 text-sm" data-i18n="slack_desc">Slack„ÉÅ„É£„É≥„Éç„É´„Å´ÈÄöÁü•„ÇíÈÄÅ‰ø°</p>
                                        </div>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" class="sr-only peer">
                                            <div class="w-14 h-7 bg-gray-600 rounded-full peer peer-checked:bg-primary peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:rounded-full after:h-6 after:w-6 after:transition-all"></div>
                                        </label>
                                    </div>
                                    <div class="py-4">
                                        <label class="block text-sm font-semibold text-gray-300 mb-3" data-i18n="slack_webhook">Slack Webhook URL</label>
                                        <input type="url" placeholder="https://hooks.slack.com/services/..." class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary">
                                    </div>
                                </div>
                            </div>

                            <!-- API Keys -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-8">
                                <div class="flex items-center justify-between mb-6">
                                    <h2 class="text-xl font-bold" data-i18n="api_keys">API„Ç≠„Éº‰∏ÄË¶ß</h2>
                                    <button class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-xl font-medium transition-all" data-i18n="generate_new_key">
                                        ‚ûï Êñ∞„Åó„ÅÑ„Ç≠„Éº„ÇíÁîüÊàê
                                    </button>
                                </div>
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between p-6 bg-gray-800/30 rounded-xl">
                                        <div>
                                            <div class="font-mono text-sm mb-1">osaifu_live_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢1234</div>
                                            <div class="text-xs text-gray-400">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ ‚Ä¢ ‰ΩúÊàê: 2024-02-15 ‚Ä¢ ÊúÄÁµÇ‰ΩøÁî®: 2ÊôÇÈñìÂâç</div>
                                        </div>
                                        <div class="flex space-x-3">
                                            <button class="text-primary hover:text-primary/80 text-sm font-medium" data-i18n="copy">„Ç≥„Éî„Éº</button>
                                            <button class="text-primary hover:text-primary/80 text-sm font-medium" data-i18n="regenerate">ÂÜçÁîüÊàê</button>
                                            <button class="text-red-400 hover:text-red-300 text-sm font-medium" data-i18n="delete">ÂâäÈô§</button>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between p-6 bg-gray-800/30 rounded-xl">
                                        <div>
                                            <div class="font-mono text-sm mb-1">osaifu_live_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢5678</div>
                                            <div class="text-xs text-gray-400">SaaSÊ±∫Ê∏à„Ç´„Éº„Éâ ‚Ä¢ ‰ΩúÊàê: 2024-02-15 ‚Ä¢ ÊúÄÁµÇ‰ΩøÁî®: 4ÊôÇÈñìÂâç</div>
                                        </div>
                                        <div class="flex space-x-3">
                                            <button class="text-primary hover:text-primary/80 text-sm font-medium" data-i18n="copy">„Ç≥„Éî„Éº</button>
                                            <button class="text-primary hover:text-primary/80 text-sm font-medium" data-i18n="regenerate">ÂÜçÁîüÊàê</button>
                                            <button class="text-red-400 hover:text-red-300 text-sm font-medium" data-i18n="delete">ÂâäÈô§</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Webhook Settings -->
                            <div class="bg-gray-900/30 border border-gray-800/50 rounded-2xl p-8">
                                <h2 class="text-xl font-bold mb-6" data-i18n="webhook_settings">WebhookË®≠ÂÆö</h2>
                                <div class="space-y-6">
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-300 mb-3" data-i18n="webhook_url">Webhook URL</label>
                                        <input type="url" placeholder="https://your-app.com/webhook" class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary">
                                    </div>
                                    <div>
                                        <h3 class="font-semibold mb-4" data-i18n="webhook_events">ÈÄÅ‰ø°„Ç§„Éô„É≥„Éà</h3>
                                        <div class="space-y-3">
                                            <label class="flex items-center space-x-3">
                                                <input type="checkbox" class="w-5 h-5 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2" checked>
                                                <span class="text-sm" data-i18n="transaction_approved">ÂèñÂºïÊâøË™ç</span>
                                            </label>
                                            <label class="flex items-center space-x-3">
                                                <input type="checkbox" class="w-5 h-5 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2" checked>
                                                <span class="text-sm" data-i18n="transaction_blocked">ÂèñÂºï„Éñ„É≠„ÉÉ„ÇØ</span>
                                            </label>
                                            <label class="flex items-center space-x-3">
                                                <input type="checkbox" class="w-5 h-5 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2">
                                                <span class="text-sm" data-i18n="card_issued">„Ç´„Éº„ÉâÁô∫Ë°å</span>
                                            </label>
                                            <label class="flex items-center space-x-3">
                                                <input type="checkbox" class="w-5 h-5 text-primary bg-gray-800 border-gray-600 rounded focus:ring-primary focus:ring-2">
                                                <span class="text-sm" data-i18n="limit_reached">‰∏äÈôêÂà∞ÈÅî</span>
                                            </label>
                                        </div>
                                    </div>
                                    <button class="bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-xl font-medium transition-all" data-i18n="save_webhook">
                                        ‰øùÂ≠ò
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <!-- Card Issuance Modal -->
    <div id="card-issuance-modal" class="modal">
        <div class="bg-gray-900 border border-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
            <!-- Modal Header -->
            <div class="p-8 border-b border-gray-800/50">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold" data-i18n="issue_new_card">Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„ÇíÁô∫Ë°å</h2>
                    <button onclick="closeCardIssuanceModal()" class="text-gray-400 hover:text-white p-2 hover:bg-gray-800 rounded-lg transition-all">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Step Progress -->
                <div class="flex items-center space-x-2 mb-2">
                    <div id="step-1-indicator" class="flex items-center space-x-2">
                        <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold">1</div>
                        <span class="text-sm font-medium text-primary" data-i18n="card_settings">„Ç´„Éº„ÉâË®≠ÂÆö</span>
                    </div>
                    <div class="h-px bg-gray-700 flex-1"></div>
                    <div id="step-2-indicator" class="flex items-center space-x-2">
                        <div class="w-8 h-8 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center text-sm font-bold">2</div>
                        <span class="text-sm font-medium text-gray-400" data-i18n="usage_rules">Âà©Áî®„É´„Éº„É´</span>
                    </div>
                    <div class="h-px bg-gray-700 flex-1"></div>
                    <div id="step-3-indicator" class="flex items-center space-x-2">
                        <div class="w-8 h-8 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center text-sm font-bold">3</div>
                        <span class="text-sm font-medium text-gray-400" data-i18n="issue_complete">Áô∫Ë°åÂÆå‰∫Ü</span>
                    </div>
                </div>
            </div>

            <!-- Modal Content -->
            <div class="p-8 relative overflow-hidden">
                <!-- Step 1: Card Settings -->
                <div id="step-1-content" class="step-content active">
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-3" data-i18n="card_name">„Ç´„Éº„ÉâÂêç</label>
                            <input id="card-name-input" type="text" placeholder="‰æã: Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ" class="w-full bg-gray-800/50 text-white px-4 py-4 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary text-lg">
                            <p class="text-xs text-gray-500 mt-2" data-i18n="card_name_desc">„Ç®„Éº„Ç∏„Çß„É≥„Éà„Åå‰ΩøÁî®„Åô„Çã„Ç´„Éº„Éâ„ÅÆÂêçÂâç</p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-3" data-i18n="agent_name">Ê∏°„ÅôÂÖà</label>
                            <input id="agent-name-input" type="text" placeholder="‰æã: Ad-Optimizer" class="w-full bg-gray-800/50 text-white px-4 py-4 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary text-lg">
                            <p class="text-xs text-gray-500 mt-2" data-i18n="agent_name_desc">„Ç´„Éº„Éâ„Çí‰ΩøÁî®„Åô„ÇãAI„Ç®„Éº„Ç∏„Çß„É≥„ÉàÂêç</p>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-3" data-i18n="currency">ÈÄöË≤®</label>
                            <div class="grid grid-cols-3 gap-4">
                                <label class="cursor-pointer">
                                    <input type="radio" name="currency" value="JPY" checked class="sr-only">
                                    <div class="currency-option border-2 border-primary bg-primary/10 rounded-xl p-4 text-center transition-all">
                                        <div class="text-2xl mb-2">¬•</div>
                                        <div class="text-sm font-medium">JPY</div>
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="currency" value="USD" class="sr-only">
                                    <div class="currency-option border-2 border-gray-700 hover:border-primary/50 rounded-xl p-4 text-center transition-all">
                                        <div class="text-2xl mb-2">$</div>
                                        <div class="text-sm font-medium">USD</div>
                                    </div>
                                </label>
                                <label class="cursor-pointer">
                                    <input type="radio" name="currency" value="BRL" class="sr-only">
                                    <div class="currency-option border-2 border-gray-700 hover:border-primary/50 rounded-xl p-4 text-center transition-all">
                                        <div class="text-2xl mb-2">R$</div>
                                        <div class="text-sm font-medium">BRL</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Usage Rules -->
                <div id="step-2-content" class="step-content">
                    <div class="space-y-8">
                        <!-- Monthly Limit -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-4" data-i18n="monthly_limit">ÊúàÈ°ç‰∏äÈôê</label>
                            <div class="space-y-4">
                                <input id="monthly-limit-slider" type="range" min="10000" max="1000000" value="200000" class="w-full range-slider">
                                <div class="flex items-center space-x-4">
                                    <span class="text-sm text-gray-400">¬•10,000</span>
                                    <input id="monthly-limit-input" type="number" min="10000" max="1000000" value="200000" class="flex-1 bg-gray-800/50 text-white px-4 py-2 rounded-lg border border-gray-700/50 focus:outline-none focus:border-primary text-center font-mono text-lg font-bold">
                                    <span class="text-sm text-gray-400">¬•1,000,000</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Per Transaction Limit -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-4" data-i18n="per_transaction_limit">1Âõû„ÅÇ„Åü„Çä„ÅÆ‰∏äÈôê</label>
                            <input id="transaction-limit-input" type="number" value="50000" class="w-full bg-gray-800/50 text-white px-4 py-4 rounded-xl border border-gray-700/50 focus:outline-none focus:border-primary font-mono text-lg">
                        </div>
                        
                        <!-- Categories -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-4" data-i18n="allowed_categories">Âà©Áî®„Ç´„ÉÜ„Ç¥„É™Âà∂Èôê</label>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-3 p-3 bg-gray-800/30 rounded-lg hover:bg-gray-800/50 cursor-pointer transition-all">
                                    <input type="checkbox" class="w-5 h-5 text-primary bg-gray-700 border-gray-600 rounded focus:ring-primary focus:ring-2">
                                    <span data-i18n="category_ads">Â∫ÉÂëä</span>
                                </label>
                                <label class="flex items-center space-x-3 p-3 bg-gray-800/30 rounded-lg hover:bg-gray-800/50 cursor-pointer transition-all">
                                    <input type="checkbox" class="w-5 h-5 text-primary bg-gray-700 border-gray-600 rounded focus:ring-primary focus:ring-2" checked>
                                    <span data-i18n="category_cloud">„ÇØ„É©„Ç¶„Éâ</span>
                                </label>
                                <label class="flex items-center space-x-3 p-3 bg-gray-800/30 rounded-lg hover:bg-gray-800/50 cursor-pointer transition-all">
                                    <input type="checkbox" class="w-5 h-5 text-primary bg-gray-700 border-gray-600 rounded focus:ring-primary focus:ring-2">
                                    <span data-i18n="category_saas">SaaS</span>
                                </label>
                                <label class="flex items-center space-x-3 p-3 bg-gray-800/30 rounded-lg hover:bg-gray-800/50 cursor-pointer transition-all">
                                    <input type="checkbox" class="w-5 h-5 text-primary bg-gray-700 border-gray-600 rounded focus:ring-primary focus:ring-2" checked>
                                    <span data-i18n="category_all">ÂÖ®Ë®±ÂèØ</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- Approval Threshold -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-300 mb-4" data-i18n="approval_required">È´òÈ°çÊ±∫Ê∏à„ÅÆÊâøË™ç</label>
                            <div class="flex items-center space-x-4 p-4 bg-gray-800/30 rounded-xl">
                                <input id="approval-threshold" type="number" value="50000" class="bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600/50 focus:outline-none focus:border-primary font-mono w-32">
                                <span class="text-gray-400" data-i18n="approval_desc">ÂÜÜ‰ª•‰∏ä„ÅØÊâøË™çÂøÖË¶Å</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Issue Complete -->
                <div id="step-3-content" class="step-content">
                    <div class="space-y-8 text-center">
                        <h3 class="text-2xl font-bold text-green-400 mb-8" data-i18n="issue_complete_title">Áô∫Ë°åÂÆå‰∫Ü ‚Äî „Ç®„Éº„Ç∏„Çß„É≥„ÉàÊé•Á∂ö„Ç¨„Ç§„Éâ</h3>
                        
                        <!-- 3D Card Visual -->
                        <div class="flex justify-center mb-8">
                            <div class="card-3d card-3d-appear relative">
                                <div class="absolute inset-0 flex flex-col justify-between">
                                    <div class="flex justify-between items-start">
                                        <div class="text-white">
                                            <div class="text-sm opacity-80">osAIfu Card</div>
                                            <div class="font-bold text-lg" id="success-card-name">Â∫ÉÂëäÈÅãÁî®„Ç´„Éº„Éâ</div>
                                        </div>
                                        <div class="text-white text-2xl font-bold">VISA</div>
                                    </div>
                                    <div class="flex justify-between items-end text-white">
                                        <div>
                                            <div class="text-xs opacity-80">**** **** **** <span id="success-card-digits">1234</span></div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-xs opacity-80">Monthly Limit</div>
                                            <div class="font-bold" id="success-monthly-limit">¬•200,000</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Connection Guide -->
                        <div class="bg-gray-800/30 border border-gray-700 rounded-xl p-8 text-left">
                            <h4 class="text-xl font-bold mb-6 text-center" data-i18n="agent_connection_guide">„Åì„ÅÆ„Ç´„Éº„Éâ„ÇíAI„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Êé•Á∂ö„Åô„ÇãÊñπÊ≥ï</h4>
                            
                            <div class="space-y-6">
                                <!-- Step 1: API Key -->
                                <div class="border-b border-gray-700/50 pb-6">
                                    <h5 class="font-semibold text-primary mb-3" data-i18n="connection_step1">„Çπ„ÉÜ„ÉÉ„Éó1: API„Ç≠„Éº„Çí„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Ë®≠ÂÆö</h5>
                                    <div class="bg-gray-900/50 border border-gray-700 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <span class="text-sm font-mono">OSAIFU_API_KEY=<span id="api-key-display">sk_live_xxxxxxxxxxxxx</span></span>
                                            <button onclick="copyTextToClipboard(document.getElementById('api-key-display').textContent)" class="copy-button bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg font-medium text-sm transition-all">
                                                <span data-i18n="copy">„Ç≥„Éî„Éº</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Step 2: Card ID -->
                                <div class="border-b border-gray-700/50 pb-6">
                                    <h5 class="font-semibold text-primary mb-3" data-i18n="connection_step2">„Çπ„ÉÜ„ÉÉ„Éó2: „Ç´„Éº„ÉâID„ÇíÊåáÂÆö„Åó„Å¶Ê±∫Ê∏à</h5>
                                    <div class="bg-gray-900/50 border border-gray-700 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <span class="text-sm font-mono">card_id: <span id="card-id-display">card_xxxxxxxx</span></span>
                                            <button onclick="copyTextToClipboard(document.getElementById('card-id-display').textContent)" class="copy-button bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg font-medium text-sm transition-all">
                                                <span data-i18n="copy">„Ç≥„Éî„Éº</span>
                                            </button>
                                        </div>
                                        <p class="text-xs text-gray-400 mt-3" data-i18n="card_rules_desc">
                                            „Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅåosAIfu API„Å´Ê±∫Ê∏à„É™„ÇØ„Ç®„Çπ„Éà„ÇíÈÄÅ„Çã„Å®„ÄÅ<br/>
                                            „Åì„ÅÆ„Ç´„Éº„Éâ„ÅÆ„É´„Éº„É´ÔºàÊúàÈ°ç‰∏äÈôê„Éª„Ç´„ÉÜ„Ç¥„É™Âà∂ÈôêÔºâ„Å´Âü∫„Å•„ÅÑ„Å¶<br/>
                                            Ëá™Âãï„ÅßÊâøË™ç/„Éñ„É≠„ÉÉ„ÇØ„Åï„Çå„Åæ„Åô„ÄÇ
                                        </p>
                                    </div>
                                </div>
                                
                                <!-- Python SDK Sample -->
                                <div>
                                    <h5 class="font-semibold text-primary mb-3" data-i18n="python_sdk_sample">Python SDK „Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ</h5>
                                    <div class="bg-gray-900/50 border border-gray-700 rounded-lg p-4 relative">
                                        <button onclick="copyPythonSample()" class="copy-button absolute top-3 right-3 bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg font-medium text-xs transition-all">
                                            <span data-i18n="copy">„Ç≥„Éî„Éº</span>
                                        </button>
                                        <pre class="text-sm text-green-400 overflow-x-auto pr-16"><code id="python-sample">from osaifu import OsAifuClient
client = OsAifuClient(api_key="sk_live_xxx")

# „Åì„ÅÆ„Ç´„Éº„Éâ„ÅßÊ±∫Ê∏à
payment = client.pay(
    card_id="card_xxxxxxxx",
    amount=45000,
    merchant="Google Ads",
    description="Â∫ÉÂëäË≤ª"
)</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Success Message -->
                        <div class="bg-green-900/20 border border-green-500/30 rounded-xl p-6">
                            <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </div>
                            <h3 class="text-xl font-bold text-green-400 mb-2" data-i18n="card_issued_success">„Ç´„Éº„ÉâÁô∫Ë°åÂÆå‰∫ÜÔºÅ</h3>
                            <p class="text-gray-300 text-sm" data-i18n="ready_to_use">„Ç´„Éº„Éâ„ÅÆÊ∫ñÂÇô„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ‰∏äË®ò„ÅÆÊÉÖÂ†±„Çí„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-8 border-t border-gray-800/50">
                <div class="flex justify-between">
                    <button id="back-button" onclick="previousStep()" class="px-6 py-3 text-gray-400 hover:text-white transition-colors font-medium" style="display: none;" data-i18n="back">
                        Êàª„Çã
                    </button>
                    <div class="flex space-x-4 ml-auto">
                        <button onclick="closeCardIssuanceModal()" class="px-6 py-3 text-gray-400 hover:text-white transition-colors font-medium" data-i18n="cancel">
                            „Ç≠„É£„É≥„Çª„É´
                        </button>
                        <button id="next-button" onclick="nextStep()" class="bg-primary hover:bg-primary/90 text-white px-8 py-3 rounded-xl font-medium transition-all" data-i18n="next">
                            Ê¨°„Å∏
                        </button>
                        <button id="issue-button" onclick="issueCard()" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-medium transition-all" style="display: none;" data-i18n="issue_card">
                            Áô∫Ë°å„Åô„Çã
                        </button>
                        <button id="done-button" onclick="closeCardIssuanceModal()" class="bg-primary hover:bg-primary/90 text-white px-8 py-3 rounded-xl font-medium transition-all" style="display: none;" data-i18n="done">
                            ÂÆå‰∫Ü
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Translations
        const translations = {
            jp: {
                home: "„Éõ„Éº„É†",
                home_subtitle: "AI„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅÆ„Ç´„Éº„Éâ„ÇíÁÆ°ÁêÜ",
                issue_card: "„Ç´„Éº„ÉâÁô∫Ë°å",
                transactions: "ÂèñÂºïÂ±•Ê≠¥",
                settings: "Ë®≠ÂÆö",
                monthly_spend: "‰ªäÊúà„ÅÆÂà©Áî®È°ç",
                issued_cards: "Áô∫Ë°å„Ç´„Éº„ÉâÊï∞",
                all_active: "„Åô„Åπ„Å¶ÊúâÂäπ",
                card_list: "„Ç´„Éº„Éâ‰∏ÄË¶ß",
                new_card: "‚ûï Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„ÇíÁô∫Ë°å",
                active: "ÊúâÂäπ",
                paused: "‰∏ÄÊôÇÂÅúÊ≠¢",
                card_details: "„Ç´„Éº„ÉâË©≥Á¥∞",
                currency: "ÈÄöË≤®",
                created: "‰ΩúÊàêÊó•",
                usage_rules: "Âà©Áî®„É´„Éº„É´",
                per_transaction: "1Âõû‰∏äÈôê",
                categories: "„Ç´„ÉÜ„Ç¥„É™",
                approval_limit: "ÊâøË™çÂøÖË¶Å",
                all_cards: "„Åô„Åπ„Å¶„ÅÆ„Ç´„Éº„Éâ",
                all_status: "„Åô„Åπ„Å¶„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ",
                approved: "ÊâøË™ç",
                blocked: "„Éñ„É≠„ÉÉ„ÇØ",
                last_30_days: "ÈÅéÂéª30Êó•",
                last_7_days: "ÈÅéÂéª7Êó•",
                today: "‰ªäÊó•",
                datetime: "Êó•ÊôÇ",
                card_name: "„Ç´„Éº„ÉâÂêç",
                merchant: "Âä†ÁõüÂ∫ó",
                amount: "ÈáëÈ°ç",
                status: "„Çπ„ÉÜ„Éº„Çø„Çπ",
                notifications: "ÈÄöÁü•Ë®≠ÂÆö",
                email_notifications: "„É°„Éº„É´ÈÄöÁü•",
                email_desc: "ÂèñÂºï„ÅÆÊâøË™ç/„Éñ„É≠„ÉÉ„ÇØÊôÇ„Å´„É°„Éº„É´„ÇíÂèó‰ø°",
                slack_notifications: "SlackÈÄöÁü•",
                slack_desc: "Slack„ÉÅ„É£„É≥„Éç„É´„Å´ÈÄöÁü•„ÇíÈÄÅ‰ø°",
                slack_webhook: "Slack Webhook URL",
                api_keys: "API„Ç≠„Éº‰∏ÄË¶ß",
                generate_new_key: "‚ûï Êñ∞„Åó„ÅÑ„Ç≠„Éº„ÇíÁîüÊàê",
                copy: "„Ç≥„Éî„Éº",
                regenerate: "ÂÜçÁîüÊàê",
                delete: "ÂâäÈô§",
                webhook_settings: "WebhookË®≠ÂÆö",
                webhook_url: "Webhook URL",
                webhook_events: "ÈÄÅ‰ø°„Ç§„Éô„É≥„Éà",
                transaction_approved: "ÂèñÂºïÊâøË™ç",
                transaction_blocked: "ÂèñÂºï„Éñ„É≠„ÉÉ„ÇØ",
                card_issued: "„Ç´„Éº„ÉâÁô∫Ë°å",
                limit_reached: "‰∏äÈôêÂà∞ÈÅî",
                save_webhook: "‰øùÂ≠ò",
                issue_new_card: "Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„ÇíÁô∫Ë°å",
                card_settings: "„Ç´„Éº„ÉâË®≠ÂÆö",
                card_name: "„Ç´„Éº„ÉâÂêç",
                card_name_desc: "„Ç®„Éº„Ç∏„Çß„É≥„Éà„Åå‰ΩøÁî®„Åô„Çã„Ç´„Éº„Éâ„ÅÆÂêçÂâç",
                agent_name: "Ê∏°„ÅôÂÖà",
                agent_name_desc: "„Ç´„Éº„Éâ„Çí‰ΩøÁî®„Åô„ÇãAI„Ç®„Éº„Ç∏„Çß„É≥„ÉàÂêç",
                monthly_limit: "ÊúàÈ°ç‰∏äÈôê",
                per_transaction_limit: "1Âõû„ÅÇ„Åü„Çä„ÅÆ‰∏äÈôê",
                allowed_categories: "Âà©Áî®„Ç´„ÉÜ„Ç¥„É™Âà∂Èôê",
                category_ads: "Â∫ÉÂëä",
                category_cloud: "„ÇØ„É©„Ç¶„Éâ",
                category_saas: "SaaS",
                category_all: "ÂÖ®Ë®±ÂèØ",
                approval_required: "È´òÈ°çÊ±∫Ê∏à„ÅÆÊâøË™ç",
                approval_desc: "ÂÜÜ‰ª•‰∏ä„ÅØÊâøË™çÂøÖË¶Å",
                card_issued_success: "„Ç´„Éº„ÉâÁô∫Ë°åÂÆå‰∫ÜÔºÅ",
                setup_agent_instruction: "„Åì„ÅÆ„Ç≠„Éº„ÇíAI„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
                connection_methods: "Êé•Á∂öÊñπÊ≥ï",
                back: "Êàª„Çã",
                cancel: "„Ç≠„É£„É≥„Çª„É´",
                next: "Ê¨°„Å∏",
                issue_card: "Áô∫Ë°å„Åô„Çã",
                done: "ÂÆå‰∫Ü",
                issue_complete: "Áô∫Ë°åÂÆå‰∫Ü",
                issue_complete_title: "Áô∫Ë°åÂÆå‰∫Ü ‚Äî „Ç®„Éº„Ç∏„Çß„É≥„ÉàÊé•Á∂ö„Ç¨„Ç§„Éâ", 
                agent_connection_guide: "„Åì„ÅÆ„Ç´„Éº„Éâ„ÇíAI„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Êé•Á∂ö„Åô„ÇãÊñπÊ≥ï",
                connection_step1: "„Çπ„ÉÜ„ÉÉ„Éó1: API„Ç≠„Éº„Çí„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Ë®≠ÂÆö",
                connection_step2: "„Çπ„ÉÜ„ÉÉ„Éó2: „Ç´„Éº„ÉâID„ÇíÊåáÂÆö„Åó„Å¶Ê±∫Ê∏à",
                card_rules_desc: "„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅåosAIfu API„Å´Ê±∫Ê∏à„É™„ÇØ„Ç®„Çπ„Éà„ÇíÈÄÅ„Çã„Å®„ÄÅ„Åì„ÅÆ„Ç´„Éº„Éâ„ÅÆ„É´„Éº„É´ÔºàÊúàÈ°ç‰∏äÈôê„Éª„Ç´„ÉÜ„Ç¥„É™Âà∂ÈôêÔºâ„Å´Âü∫„Å•„ÅÑ„Å¶Ëá™Âãï„ÅßÊâøË™ç/„Éñ„É≠„ÉÉ„ÇØ„Åï„Çå„Åæ„Åô„ÄÇ",
                python_sdk_sample: "Python SDK „Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ",
                ready_to_use: "„Ç´„Éº„Éâ„ÅÆÊ∫ñÂÇô„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ‰∏äË®ò„ÅÆÊÉÖÂ†±„Çí„Ç®„Éº„Ç∏„Çß„É≥„Éà„Å´Ë®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ"
            },
            en: {
                home: "Home",
                home_subtitle: "Manage AI Agent Cards",
                issue_card: "Issue Card",
                transactions: "Transactions",
                settings: "Settings",
                monthly_spend: "Monthly Spend",
                issued_cards: "Issued Cards",
                all_active: "All Active",
                card_list: "Card List",
                new_card: "‚ûï Issue New Card",
                active: "Active",
                paused: "Paused",
                card_details: "Card Details",
                currency: "Currency",
                created: "Created",
                usage_rules: "Usage Rules",
                per_transaction: "Per Transaction",
                categories: "Categories",
                approval_limit: "Approval Required",
                all_cards: "All Cards",
                all_status: "All Status",
                approved: "Approved",
                blocked: "Blocked",
                last_30_days: "Last 30 Days",
                last_7_days: "Last 7 Days",
                today: "Today",
                datetime: "Date/Time",
                card_name: "Card Name",
                merchant: "Merchant",
                amount: "Amount",
                status: "Status",
                notifications: "Notifications",
                email_notifications: "Email Notifications",
                email_desc: "Receive emails for transaction approvals/blocks",
                slack_notifications: "Slack Notifications",
                slack_desc: "Send notifications to Slack channel",
                slack_webhook: "Slack Webhook URL",
                api_keys: "API Keys",
                generate_new_key: "‚ûï Generate New Key",
                copy: "Copy",
                regenerate: "Regenerate",
                delete: "Delete",
                webhook_settings: "Webhook Settings",
                webhook_url: "Webhook URL",
                webhook_events: "Events to Send",
                transaction_approved: "Transaction Approved",
                transaction_blocked: "Transaction Blocked",
                card_issued: "Card Issued",
                limit_reached: "Limit Reached",
                save_webhook: "Save",
                issue_new_card: "Issue New Card",
                card_settings: "Card Settings",
                card_name: "Card Name",
                card_name_desc: "Name for the card the agent will use",
                agent_name: "Agent Name",
                agent_name_desc: "Name of the AI agent using this card",
                monthly_limit: "Monthly Limit",
                per_transaction_limit: "Per Transaction Limit",
                allowed_categories: "Allowed Categories",
                category_ads: "Advertising",
                category_cloud: "Cloud",
                category_saas: "SaaS",
                category_all: "All Allowed",
                approval_required: "High-Value Approval",
                approval_desc: "and above requires approval",
                card_issued_success: "Card Issued Successfully!",
                setup_agent_instruction: "Set this key in your AI agent",
                connection_methods: "Connection Methods",
                back: "Back",
                cancel: "Cancel",
                next: "Next",
                issue_card: "Issue Card",
                done: "Done",
                issue_complete: "Issue Complete",
                issue_complete_title: "Issue Complete ‚Äî Agent Connection Guide",
                agent_connection_guide: "How to connect this card to your AI Agent",
                connection_step1: "Step 1: Set API key in your agent",
                connection_step2: "Step 2: Use card ID for payments",
                card_rules_desc: "When your agent sends payment requests to osAIfu API, they will be automatically approved/blocked based on this card's rules (monthly limit, category restrictions).",
                python_sdk_sample: "Python SDK Sample Code",
                ready_to_use: "Your card is ready to use. Please configure the above information in your agent."
            }
        };

        let currentLanguage = 'jp';
        let currentStep = 1;
        let generatedCardId = '';
        let generatedApiKey = '';
        let cards = [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeSliders();
            initializeCurrencySelection();
            updateTranslations();
        });

        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update button states
            document.getElementById('lang-jp').classList.toggle('active', lang === 'jp');
            document.getElementById('lang-en').classList.toggle('active', lang === 'en');
            
            updateTranslations();
        }

        function updateTranslations() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        // View switching
        function showView(viewName) {
            // Hide all views
            const views = document.querySelectorAll('.view-section');
            views.forEach(view => view.style.display = 'none');
            
            // Show selected view
            const targetView = document.getElementById(viewName + '-view');
            if (targetView) {
                targetView.style.display = 'block';
            }
            
            // Update navigation active state
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            
            // Update page title
            const titleMap = {
                home: { title: translations[currentLanguage].home, subtitle: translations[currentLanguage].home_subtitle },
                transactions: { title: translations[currentLanguage].transactions, subtitle: "„Åô„Åπ„Å¶„ÅÆÂèñÂºï„ÇíË°®Á§∫" },
                settings: { title: translations[currentLanguage].settings, subtitle: "„Ç¢„Ç´„Ç¶„É≥„ÉàË®≠ÂÆö„ÇíÁÆ°ÁêÜ" }
            };
            
            if (titleMap[viewName]) {
                document.getElementById('page-title').textContent = titleMap[viewName].title;
                document.getElementById('page-subtitle').textContent = titleMap[viewName].subtitle;
            }
        }

        // Mobile sidebar
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('hidden');
        }

        // Card details accordion
        function toggleCardDetails(cardElement) {
            const accordionContent = cardElement.querySelector('.card-details-expanded');
            const expandIcon = cardElement.querySelector('.expand-icon');
            
            const isExpanded = accordionContent.classList.contains('active');
            
            // Close all other accordions
            document.querySelectorAll('.card-details-expanded').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.expand-icon').forEach(icon => {
                icon.style.transform = 'rotate(0deg)';
            });
            
            // Toggle current accordion
            if (!isExpanded) {
                accordionContent.classList.add('active');
                expandIcon.style.transform = 'rotate(180deg)';
            }
        }

        // Toggle card number visibility
        function toggleCardNumber(button, fullNumber) {
            const maskedSpan = button.parentElement.querySelector('#card-number-masked') || button.parentElement.querySelector('span');
            const isRevealed = button.textContent === 'Èö†„Åô' || button.textContent === 'Hide';
            
            if (isRevealed) {
                maskedSpan.textContent = '**** **** **** ' + fullNumber.slice(-4);
                button.textContent = currentLanguage === 'jp' ? 'Ë°®Á§∫' : 'Show';
            } else {
                maskedSpan.textContent = fullNumber;
                button.textContent = currentLanguage === 'jp' ? 'Èö†„Åô' : 'Hide';
                
                // Auto-hide after 10 seconds
                setTimeout(() => {
                    maskedSpan.textContent = '**** **** **** ' + fullNumber.slice(-4);
                    button.textContent = currentLanguage === 'jp' ? 'Ë°®Á§∫' : 'Show';
                }, 10000);
            }
        }

        // Toggle CVC visibility
        function toggleCVC(button, fullCVC) {
            const maskedSpan = button.parentElement.querySelector('#cvc-masked') || button.parentElement.querySelector('span');
            const isRevealed = button.textContent === 'Èö†„Åô' || button.textContent === 'Hide';
            
            if (isRevealed) {
                maskedSpan.textContent = '***';
                button.textContent = currentLanguage === 'jp' ? 'Ë°®Á§∫' : 'Show';
            } else {
                maskedSpan.textContent = fullCVC;
                button.textContent = currentLanguage === 'jp' ? 'Èö†„Åô' : 'Hide';
                
                // Auto-hide after 10 seconds
                setTimeout(() => {
                    maskedSpan.textContent = '***';
                    button.textContent = currentLanguage === 'jp' ? 'Ë°®Á§∫' : 'Show';
                }, 10000);
            }
        }

        // Copy text to clipboard with feedback
        function copyTextToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                // Visual feedback could be added here
                console.log('Copied: ' + text);
            });
        }

        // Inline editing
        function enableInlineEdit(event, element) {
            event.stopPropagation();
            
            const currentValue = element.getAttribute('data-current');
            const maxValue = element.getAttribute('data-max');
            
            const input = document.createElement('input');
            input.type = 'number';
            input.value = currentValue;
            input.className = 'inline-edit-input';
            input.style.width = '120px';
            
            input.addEventListener('blur', function() {
                const newValue = parseInt(this.value);
                if (newValue && newValue <= parseInt(maxValue)) {
                    element.setAttribute('data-current', newValue);
                    element.textContent = '¬•' + newValue.toLocaleString();
                    
                    // Update progress bar
                    const progressBar = element.closest('.card-row').querySelector('.progress-bar');
                    const percentage = (newValue / parseInt(maxValue)) * 100;
                    progressBar.style.width = percentage + '%';
                } else {
                    element.textContent = '¬•' + parseInt(currentValue).toLocaleString();
                }
                element.style.display = 'inline';
            });
            
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            });
            
            element.style.display = 'none';
            element.parentNode.insertBefore(input, element.nextSibling);
            input.focus();
            input.select();
        }

        // Card Issuance Modal
        function openCardIssuanceModal() {
            document.getElementById('card-issuance-modal').classList.add('active');
            currentStep = 1;
            updateStepIndicators();
            resetModal();
        }

        function closeCardIssuanceModal() {
            document.getElementById('card-issuance-modal').classList.remove('active');
            resetModal();
        }

        function resetModal() {
            currentStep = 1;
            
            // Reset form
            document.getElementById('card-name-input').value = '';
            document.getElementById('agent-name-input').value = '';
            document.getElementById('monthly-limit-slider').value = 200000;
            document.getElementById('monthly-limit-input').value = 200000;
            document.getElementById('transaction-limit-input').value = 50000;
            document.getElementById('approval-threshold').value = 50000;
            
            // Reset currency selection
            document.querySelectorAll('input[name="currency"]').forEach(radio => {
                radio.checked = radio.value === 'JPY';
            });
            updateCurrencySelection();
            
            // Reset steps
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active', 'prev');
            });
            document.getElementById('step-1-content').classList.add('active');
            
            // Hide step 3 button
            document.getElementById('done-button').style.display = 'none';
            
            updateStepIndicators();
        }

        function nextStep() {
            if (currentStep === 1) {
                // Validate step 1
                const cardName = document.getElementById('card-name-input').value.trim();
                const agentName = document.getElementById('agent-name-input').value.trim();
                
                if (!cardName || !agentName) {
                    alert('„Ç´„Éº„ÉâÂêç„Å®Ê∏°„ÅôÂÖà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }
                
                currentStep = 2;
                showStep(2);
            }
        }

        function previousStep() {
            if (currentStep === 3) {
                currentStep = 2;
                showStep(2);
            } else if (currentStep === 2) {
                currentStep = 1;
                showStep(1);
            }
        }

        function showStep(step) {
            // Update content visibility
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById(`step-${step}-content`).classList.add('active');
            updateStepIndicators();
        }

        function updateStepIndicators() {
            // Update step indicators
            for (let i = 1; i <= 3; i++) {
                const indicator = document.getElementById(`step-${i}-indicator`);
                const circle = indicator.querySelector('div');
                const text = indicator.querySelector('span');
                
                if (i <= currentStep) {
                    circle.className = 'w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center text-sm font-bold';
                    text.className = 'text-sm font-medium text-primary';
                } else {
                    circle.className = 'w-8 h-8 rounded-full bg-gray-700 text-gray-400 flex items-center justify-center text-sm font-bold';
                    text.className = 'text-sm font-medium text-gray-400';
                }
            }
            
            // Update buttons
            document.getElementById('back-button').style.display = currentStep > 1 && currentStep < 3 ? 'block' : 'none';
            document.getElementById('next-button').style.display = currentStep < 2 ? 'block' : 'none';
            document.getElementById('issue-button').style.display = currentStep === 2 ? 'block' : 'none';
            document.getElementById('done-button').style.display = currentStep === 3 ? 'block' : 'none';
        }

        function issueCard() {
            // Collect form data
            const cardName = document.getElementById('card-name-input').value.trim();
            const agentName = document.getElementById('agent-name-input').value.trim();
            const currency = document.querySelector('input[name="currency"]:checked').value;
            const monthlyLimit = document.getElementById('monthly-limit-input').value;
            
            // Generate API key and card ID
            generatedApiKey = generateApiKey();
            generatedCardId = generateCardId();
            const cardDigits = generateCardDigits();
            
            // Update Step 3 content
            document.getElementById('success-card-name').textContent = cardName;
            document.getElementById('success-monthly-limit').textContent = 
                (currency === 'JPY' ? '¬•' : currency === 'USD' ? '$' : 'R$') + parseInt(monthlyLimit).toLocaleString();
            document.getElementById('success-card-digits').textContent = cardDigits;
            document.getElementById('api-key-display').textContent = generatedApiKey;
            document.getElementById('card-id-display').textContent = generatedCardId;
            
            // Update Python sample code
            updatePythonSample(generatedApiKey, generatedCardId);
            
            // Move to Step 3
            currentStep = 3;
            showStep(3);
            
            // Add card to list (this would normally be handled by backend)
            addCardToList({
                name: cardName,
                agent: agentName,
                currency: currency,
                monthlyLimit: monthlyLimit,
                currentUsage: 0,
                status: 'active',
                apiKey: generatedApiKey,
                cardId: generatedCardId,
                cardDigits: cardDigits
            });
        }

        function generateApiKey() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = 'sk_live_';
            for (let i = 0; i < 24; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateCardId() {
            const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
            let result = 'card_';
            for (let i = 0; i < 12; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateCardDigits() {
            return Math.floor(1000 + Math.random() * 9000).toString();
        }

        function updatePythonSample(apiKey, cardId) {
            const sampleCode = `from osaifu import OsAifuClient
client = OsAifuClient(api_key="${apiKey}")

# „Åì„ÅÆ„Ç´„Éº„Éâ„ÅßÊ±∫Ê∏à
payment = client.pay(
    card_id="${cardId}",
    amount=45000,
    merchant="Google Ads",
    description="Â∫ÉÂëäË≤ª"
)`;
            document.getElementById('python-sample').textContent = sampleCode;
        }

        function copyPythonSample() {
            const code = document.getElementById('python-sample').textContent;
            copyTextToClipboard(code);
            
            // Show feedback
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '<span data-i18n="copy">„Ç≥„Éî„ÉºÂÆå‰∫ÜÔºÅ</span>';
            button.classList.add('bg-green-600');
            button.classList.remove('bg-primary');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('bg-green-600');
                button.classList.add('bg-primary');
            }, 2000);
        }

        function addCardToList(cardData) {
            const cardCount = document.getElementById('card-count');
            const currentCount = parseInt(cardCount.textContent);
            cardCount.textContent = currentCount + 1;
            
            // In a real application, you would add the card to the list and refresh the view
            console.log('Card added:', cardData);
        }

        function copyApiKey() {
            const apiKeyText = document.getElementById('api-key-display').textContent;
            copyTextToClipboard(apiKeyText);
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '„Ç≥„Éî„ÉºÂÆå‰∫ÜÔºÅ';
            button.classList.add('bg-green-600');
            button.classList.remove('bg-primary');
            
            setTimeout(() => {
                button.textContent = originalText;
                button.classList.remove('bg-green-600');
                button.classList.add('bg-primary');
            }, 2000);
        }

        // Initialize sliders
        function initializeSliders() {
            const monthlySlider = document.getElementById('monthly-limit-slider');
            const monthlyInput = document.getElementById('monthly-limit-input');
            
            if (monthlySlider && monthlyInput) {
                monthlySlider.addEventListener('input', function() {
                    monthlyInput.value = this.value;
                });
                
                monthlyInput.addEventListener('input', function() {
                    monthlySlider.value = this.value;
                });
            }
        }

        // Initialize currency selection
        function initializeCurrencySelection() {
            document.querySelectorAll('input[name="currency"]').forEach(radio => {
                radio.addEventListener('change', updateCurrencySelection);
            });
        }

        function updateCurrencySelection() {
            const selected = document.querySelector('input[name="currency"]:checked');
            document.querySelectorAll('.currency-option').forEach(option => {
                option.classList.remove('border-primary', 'bg-primary/10');
                option.classList.add('border-gray-700');
            });
            
            if (selected) {
                const option = selected.nextElementSibling;
                option.classList.remove('border-gray-700');
                option.classList.add('border-primary', 'bg-primary/10');
            }
        }
    </script>
</body>
</html><!-- cache bust 1771339008 -->
